<!DOCTYPE html>
<html lang="ja" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="format-detection" content="telephone=no,email=no,address=no">
    <title></title>
    <style media="screen">
      * {
        margin: 0;
        padding: 0;
      }
      .none {
        display: none;
      }

      #container {
        width: 100%;
        height: 100vh;
        position: relative;
        overflow: hidden;
        background-size: cover;
        background-position: center;
        -webkit-transition: background-image 2.5s;
           -moz-transition: background-image 2.5s;
            -ms-transition: background-image 2.5s;
             -o-transition: background-image 2.5s;
                transition: background-image 2.5s;
      }


      #clock {
        padding: 10px;
        position: absolute;
        left: 1vw;
        bottom: 1vh;
        filter: drop-shadow(0 0 10px black);
        color: #fff;
      }
      #clock .time {
        font-size: calc((115% + 0.5vw) * 3);
        line-height: calc(95% + 0.5vw);
      }
      #clock .date {
        font-size: calc((115% + 0.5vw) * 1.2);
        line-height: calc(95% + 0.5vw);
      }

      #imageSwitch {
        width: 100%;
        height: 100%;
        position: fixed;
      }

      #option {
        width: 100vw;
        height: 100vh;
        position: absolute;
        background: rgba(255,255,255,.9);

        transform: translate3d(0,-102%,0);
        -webkit-transition: transform .5s;
           -moz-transition: transform .5s;
            -ms-transition: transform .5s;
             -o-transition: transform .5s;
                transition: transform .5s;
      }
      #option.view {
        transform: translate3d(0,0,0);
      }
      #option .checks {
        height: 100%;
        color: #fff;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-content: center;
      }
      #option .checks div {
        margin: 3vh 1vw 0 1vw;
      }
      #option input[type="checkbox"]{
        -webkit-appearance: none;  /* 元々のチェックボックスを非表示 */
        display: none;
      }
      #option input[type="checkbox"] + span,
      #option input[type="checkbox"] + img{
        width: calc(100vw / 9);

        -webkit-filter: grayscale(100%)drop-shadow(0 0 5px #555);
           -moz-filter: grayscale(100%)drop-shadow(0 0 5px #555);
            -ms-filter: grayscale(100%)drop-shadow(0 0 5px #555);
             -o-filter: grayscale(100%)drop-shadow(0 0 5px #555);
                filter: grayscale(100%)drop-shadow(0 0 5px #555);
      }
      #option input[type="checkbox"]:checked + span,
      #option input[type="checkbox"]:checked + img {
        -webkit-filter: drop-shadow(0 0 5px #00a8ff);
           -moz-filter: drop-shadow(0 0 5px #00a8ff);
            -ms-filter: drop-shadow(0 0 5px #00a8ff);
             -o-filter: drop-shadow(0 0 5px #00a8ff);
                filter: drop-shadow(0 0 5px #00a8ff);
      }
      #option label span {
        color: #fff;
        font-size: calc(100vw / 8 - 25px);
        line-height: calc(100vw / 8 + 5px);
      }
    </style>
  </head>
  <body>
    <div id="container">
      <div id="imageSwitch"></div>
      <div id="clock">
        <div class="time">
          <span>00:00</span>
        </div>
        <div class="date">
          <span>1月1日 (月)</span>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      const eContainer = document.getElementById('container');
      const eImgSwitch = document.getElementById('imageSwitch');

      const eClock = document.getElementById('clock');
      const eTime = document.querySelector('#clock .time');
      const eDate = document.querySelector('#clock .date');

      let imageList = [
        {"url":'./images/000.png',"idol":[13,14,15],"center":[50,50]},
        {"url":'./images/001.png',"idol":[13,14,15],"center":[50,50]},
        {"url":'./images/002.png',"idol":[14],"center":[50,50]},
        {"url":'./images/003.png',"idol":[14],"center":[50,50]},
      ];
      let slideIndex = 0;
      let sChangeMinutes = new Date().getMinutes();

      eImgSwitch.addEventListener('touchstart',(e) => {
        imageSlide();
      });

      eClock.addEventListener('touchstart',(e) => {
        setting();
      });

      const setting = () => {
        eOption.classList.toggle('view');
      };

      // 時計変更
      const changeClock = () => {
        const weekdays = ["日", "月", "火", "水", "木", "金", "土"];
        const t = new Date();
        const timeText = `${zero(t.getHours())}:${zero(t.getMinutes())}`
        const dateText = `${t.getMonth()+1}月${t.getDate()}日 (${weekdays[t.getDay()]})`

        eTime.textContent = timeText;
        eDate.textContent = dateText;

        if (t.getMinutes()%5 == 0 && t.getMinutes() != sChangeMinutes) {
          sChangeMinutes = t.getMinutes();
          imageSlide();
        }
      };

      // 背景画像変更
      const imageSlide = () => {
        let i = slideIndex % imageList.length;
        let cash = new Image();
        cash.onload = () => {
          eContainer.style.backgroundImage = `url(${imageList[i].url})`;
          slideIndex++;
        };
        cash.src = imageList[i].url;
      };

      // 画像URLリストをシャッフル
      const shuffleList = () => {
        for(var i = imageList.length - 1; i > 0; i--){
          var r = Math.floor(Math.random() * (i + 1));
          var tmp = imageList[i];
          imageList[i] = imageList[r];
          imageList[r] = tmp;
        }
      };

      // 一文字の数字の先頭に0を追加
      const zero = (e) => {
        let str = '' + e;
        if (str.length < 2) str = '0' + str;
        return str;
      };

      // setting();
      shuffleList();
      imageSlide();
      setInterval(function () {
        changeClock();
      }, 100);
    </script>
  </body>
</html>
